{% extends "base.j2" %}

{% block content %}

<!-- Form -->
<form action="{{ url_for('core.index') }}" method="post" enctype="multipart/form-data" class="space-y-4" role="form">
    <!-- App Name Input -->
    <div>
        <label for="app_name"
            class="block mb-2 text-xs font-semibold text-slate-500 uppercase tracking-wide">Application Name</label>
        <input type="text" id="app_name" name="app_name" placeholder="e.g. MySplunkApp"
            class="bg-slate-50 border border-slate-200 text-slate-800 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 transition-all outline-none">
    </div>

    <!-- Upload Area -->
    <div class="relative group">
        <label id="drop-zone" for="file-upload"
            class="flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-slate-300 rounded-xl cursor-pointer bg-slate-50 hover:bg-slate-100 hover:border-emerald-500 transition-all duration-200">
            <div class="flex flex-col items-center justify-center pt-5 pb-6">
                <svg class="w-10 h-10 mb-3 text-slate-400 group-hover:text-emerald-500 transition-colors" fill="none"
                    stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12">
                    </path>
                </svg>
                <p class="mb-2 text-sm text-slate-600"><span class="font-semibold">Click to
                        upload</span> or drag and drop</p>
                <p class="text-xs text-slate-400">PNG, JPG, or WEBP (Preferably Square PNG)</p>
            </div>
            <input id="file-upload" name="file" type="file" class="hidden" accept="image/*"
                onchange="previewImage(this)" />
        </label>
    </div>

    <!-- Preview Area -->
    <div id="preview-container"
        class="hidden flex flex-wrap items-center justify-center gap-6 p-6 bg-slate-50 rounded-lg border border-slate-100">
        <!-- Source Section -->
        <div class="flex items-center gap-4">
            <div class="text-center">
                <div class="w-16 h-16 border rounded bg-white shadow-sm overflow-hidden mx-auto">
                    <img id="preview-img" class="w-full h-full object-contain" />
                </div>
                <span class="text-xs text-slate-400 mt-1">Source</span>
            </div>
            <div class="text-slate-300">â†’</div>
        </div>

        <!-- Outputs Section (Stacked) -->
        <div class="flex flex-col items-center gap-4">
            <!-- Icons Group -->
            <div class="text-center">
                <div class="flex items-end gap-2">
                    <div
                        class="w-[36px] h-[36px] bg-emerald-100 border border-emerald-200 rounded flex items-center justify-center text-[8px] text-emerald-700">
                        36px</div>
                    <div
                        class="w-[72px] h-[72px] bg-emerald-100 border border-emerald-200 rounded flex items-center justify-center text-[10px] text-emerald-700">
                        72px</div>
                </div>
                <span class="text-xs text-slate-400 mt-1 block">Icons</span>
            </div>

            <!-- Logos Group -->
            <div class="text-center">
                <div class="flex flex-col items-center justify-end gap-2">
                    <div
                        class="w-[120px] h-[30px] bg-blue-50 border border-blue-200 rounded flex items-center justify-center text-[9px] text-blue-700">
                        160x40</div>
                    <div
                        class="w-[160px] h-[40px] bg-blue-50 border border-blue-200 rounded flex items-center justify-center text-[10px] text-blue-700">
                        320x80</div>
                </div>
                <span class="text-xs text-slate-400 mt-1 block">Logos</span>
            </div>
        </div>
    </div>

    <button type="submit"
        class="w-full text-white bg-slate-900 hover:bg-slate-800 focus:ring-4 focus:ring-slate-300 font-medium rounded-lg text-sm px-5 py-3 text-center transition-all shadow-lg hover:shadow-xl">
        Generate & Download ZIP
    </button>
</form>


{% endblock content %}

{% block scripts %}
<script type="text/javascript">
    function previewImage(input) {
        if (!input) return; // Safety check
        const previewContainer = document.getElementById('preview-container');
        const previewImg = document.getElementById('preview-img');

        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function (e) {
                previewImg.src = e.target.result;
                previewContainer.classList.remove('hidden');
            }
            reader.readAsDataURL(input.files[0]);
        }
    }
    // --- Drag and Drop Logic (Vanilla JS) ---
    const dropZone = document.getElementById('drop-zone');
    const fileInput = document.getElementById('file-upload');

    // Prevent default drag behaviors
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        dropZone.addEventListener(eventName, preventDefaults, false);
        document.body.addEventListener(eventName, preventDefaults, false);
    });

    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }

    // Highlight drop zone when item is dragged over it
    ['dragenter', 'dragover'].forEach(eventName => {
        dropZone.addEventListener(eventName, highlight, false);
    });

    ['dragleave', 'drop'].forEach(eventName => {
        dropZone.addEventListener(eventName, unhighlight, false);
    });

    function highlight(e) {
        dropZone.classList.add('bg-slate-100', 'border-emerald-500');
    }

    function unhighlight(e) {
        dropZone.classList.remove('bg-slate-100', 'border-emerald-500');
    }

    // Handle dropped files
    dropZone.addEventListener('drop', handleDrop, false);

    function handleDrop(e) {
        const dt = e.dataTransfer;
        const files = dt.files;

        if (files.length > 0) {
            fileInput.files = files; // Assign dropped files to the input
            previewImage(fileInput); // Trigger preview manually
        }
    }
</script>
{% endblock scripts %}